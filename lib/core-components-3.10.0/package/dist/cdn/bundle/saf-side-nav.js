"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@saffron/config"),t=require("./define-CgQAavGn.js"),i=require("./saf-icon.js"),s=require("tslib"),a=require("@microsoft/fast-web-utilities"),n=require("./logger-vjs750p7.js"),o=require("./dialogBase-BiiI0NTo.js"),r=require("./menu-item-CKI6Iyzn.js"),l=require("./dom-helpers-DxoVHRyN.js"),d=require("./global-enums-58U8enSy.js"),u=require("./fast-element-DOTfrYFb.js"),c=require("./slotted-cZBT0SIc.js");require("./apply-mixins-CewQe2EQ.js"),require("./start-end-template-D7dQJgd3.js"),require("./ref-BeTe_0iT.js"),require("./aria-global-CYzDgx1a.js"),require("./form-associated-DSP-KUNe.js"),require("./when-0aDJpnLk.js"),require("tabbable"),require("@floating-ui/dom");const h="closed",m="open";class p extends o.DialogBase{itemsChanged(t,i){this.$fastController.isConnected&&void 0!==this.menuItems&&this.setItems(),this.items.length>0&&l.setAttributeOnChild(this,e.getComponentName("saf-menu-item"),"side-nav-item","")}constructor(){super(),this.density=d.ComponentDensityEnum.standard,this.activeIndex=0,this.state=h,this.openIconName="arrow-right-from-line",this.closeIconName="arrow-left-from-line",this.ariaLabel="Side navigation",this.ariaExpanded="true",this.menuFocusIndex=-1,this.isNavigating=!1,this.adaptiveBreakpoint=767,this._resizeTimeout=null,this.fullscreen=!1,this.isMenuItemElement=e=>e instanceof r.MenuItem||a.isHTMLElement(e)&&e.getAttribute("role")in p.menuFocusableElementRoles,this.focusableElement=e=>this.isMenuItemElement(e),this.resizeObserver=new ResizeObserver(this.handleResize.bind(this))}handleResize(t){this._resizeTimeout||(this._resizeTimeout=setTimeout(()=>{if(this.triggerId){const t=document.getElementById(this.triggerId),i=t?t.closest(e.getComponentName("saf-product-header")):null;if(i){i.offsetWidth<=this.adaptiveBreakpoint?(this.close(),this.fullscreen=!0):this.fullscreen=!1}}this._resizeTimeout=null},200)),this.toggleMenuItemText(),this.showHideTooltip(),this.showHideIcon()}open(){this.fullscreen&&this.classList.add("opening"),this.fullscreen?setTimeout(()=>{this.state=m,this.classList.remove("opening")},200):this.state=m,this.state=m,this.isNavigating=!1,this.ariaExpanded="true",this.toggleMenuItemText(),this.showHideTooltip(),this.showHideIcon(),this.$emit("open",null,{bubbles:!1});const e=document.getElementById(this.triggerId);e&&e.setAttribute("aria-expanded","true")}close(){this.state=h,this.ariaExpanded="false",this.toggleMenuItemText(),this.showHideTooltip(),this.showHideIcon(),this.$emit("close",null,{bubbles:!1});const e=document.getElementById(this.triggerId);e&&e.setAttribute("aria-expanded","false")}toggleMenuItemText(){this.querySelectorAll(e.getComponentName("saf-menu-item")).forEach(e=>{var t,i,s,a,n,o;const r=null===(i=null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("span.content"))||void 0===i?void 0:i.querySelector("slot"),l=null===(o=null===(n=null===(a=null===(s=null==e?void 0:e.shadowRoot)||void 0===s?void 0:s.querySelector("span.content"))||void 0===a?void 0:a.querySelector("slot"))||void 0===n?void 0:n.assignedNodes())||void 0===o?void 0:o[0].textContent;if("closed"===this.state)null==r||r.setAttribute("hidden","true"),e.setAttribute("aria-label",l);else e.removeAttribute("aria-label"),setTimeout(()=>{null==r||r.removeAttribute("hidden")},this.getAnimationDurationMs())})}showHideTooltip(){this.querySelectorAll(e.getComponentName("saf-tooltip")).forEach(e=>{this.state===m?e.setAttribute("hidden","true"):this.state===h&&e.removeAttribute("hidden")})}showHideIcon(){this.querySelectorAll(`${e.getComponentName("saf-icon")}[slot="end"]`).forEach(e=>{this.state===h?e.setAttribute("hidden","true"):this.state===m&&setTimeout(()=>{e.removeAttribute("hidden")},this.getAnimationDurationMs())})}getAnimationDurationMs(){const e=getComputedStyle(this).getPropertyValue("--saf-sideNav-container-transitionDuration"),t=parseFloat(e);return isNaN(t)?0:e.includes("ms")?t:1e3*t}handleClick(e){e.defaultPrevented&&n.Logger.warn("Event dispatch was prevented");const t=e.target;return e.ctrlKey||e.metaKey||1===e.button||t.hasLinkOrRouterLink&&"_blank"===t.target||this.updateSelectedItem(t),!!(e.target instanceof r.MenuItem&&this.isMenuItemElement(e.target))}updateSelectedItem(e){this.isNavigating=!0,this.items.forEach((t,i)=>{var s;const a=null===(s=e.shadowRoot)||void 0===s?void 0:s.querySelector("a");t===e?(this.activeIndex=i,this.toggleIconSelected(e,!0),null==a||a.setAttribute("aria-current","page"),this.fullscreen&&this.close()):(this.toggleIconSelected(t,!1),null==a||a.removeAttribute("aria-current"))});const t=()=>{this.isNavigating=!1};t.bind(this),u.Updates.enqueue(t)}toggleIconSelected(t,i){const s=null==t?void 0:t.querySelector(e.getComponentName("saf-icon"));"brands"!==(null==s?void 0:s.getAttribute("appearance"))&&(i?null==s||s.setAttribute("appearance","solid"):null==s||s.setAttribute("appearance","light"))}setItems(){const e=Array.from(this.children).filter(e=>!e.hasAttribute("hidden"));this.menuItems=e;const t=this.menuItems.filter(this.isMenuItemElement);t.length&&(this.menuFocusIndex=0),t.forEach((e,t)=>{e.setAttribute("tabindex",0===t?"0":"-1")})}handleMenuKeyDown(e){if(void 0===this.menuItems)return!1;if(!this.isMenuItemElement(e.target)||e.target.parentElement!==this)return!0;const t=e.target,i=e.ctrlKey||e.metaKey||t.hasLinkOrRouterLink&&"_blank"===t.target;switch(e.key){case a.keyArrowDown:return this.setMenuFocus(this.menuFocusIndex+1,1),!1;case a.keyArrowUp:return this.setMenuFocus(this.menuFocusIndex-1,-1),!1;case a.keyEnd:return this.setMenuFocus(this.menuItems.length-1,-1),!1;case a.keyHome:return this.setMenuFocus(0,1),!1;case a.keyEnter:case a.keySpace:return i||this.updateSelectedItem(e.target),!1;case a.keyEscape:return this.close(),!1;default:return!0}}setMenuFocus(e,t){if(void 0!==this.menuItems)for(;e>=0&&e<this.menuItems.length;){const i=this.menuItems[e];if(this.focusableElement(i)){this.menuFocusIndex>-1&&this.menuItems.length>=this.menuFocusIndex-1&&this.menuItems[this.menuFocusIndex].setAttribute("tabindex","-1"),this.menuFocusIndex=e,i.setAttribute("tabindex","0"),i.focus();break}e+=t}}get closeButtonElement(){var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".header-action")}get titleElement(){var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".header-title")}get isHidden(){return this.state===h}set isHidden(e){this.state=e?h:m}get hideStateAttribute(){return"state"}get isModal(){return this.fullscreen}get hasCancelEvent(){return!1}get openEventName(){return"open"}get hideEventName(){return"close"}get noFocusTrap(){return!this.fullscreen}get preventTriggerFocus(){return this.isNavigating}initialize(){this.toggleMenuItemText(),this.showHideTooltip(),this.showHideIcon(),this.resizeObserver.observe(document.body),u.Updates.enqueue(()=>{this.setItems()});const e=document.getElementById(this.triggerId);e&&(e.addEventListener("click",()=>this.open()),e.setAttribute("aria-expanded",this.state===m?"true":"false"),e.setAttribute("aria-controls",this.id),e.setAttribute("aria-haspopup","dialog"))}destroy(){this.resizeObserver.unobserve(document.body)}show(){this.open()}hide(){this.close()}}p.menuFocusableElementRoles=r.MenuItemRoleEnum,s.__decorate([u.attr],p.prototype,"density",void 0),s.__decorate([u.observable],p.prototype,"activeIndex",void 0),s.__decorate([u.observable],p.prototype,"items",void 0),s.__decorate([u.observable],p.prototype,"titleNodes",void 0),s.__decorate([u.attr,u.observable],p.prototype,"state",void 0),s.__decorate([u.attr({attribute:"open-icon-name"})],p.prototype,"openIconName",void 0),s.__decorate([u.attr({attribute:"close-icon-name"})],p.prototype,"closeIconName",void 0),s.__decorate([u.attr({attribute:"aria-label"})],p.prototype,"ariaLabel",void 0),s.__decorate([u.attr({attribute:"close-aria-label"})],p.prototype,"closeAriaLabel",void 0),s.__decorate([u.attr({attribute:"open-aria-label"})],p.prototype,"openAriaLabel",void 0),s.__decorate([u.observable],p.prototype,"ariaExpanded",void 0),s.__decorate([u.observable],p.prototype,"shouldShowFullscreen",void 0),s.__decorate([u.observable],p.prototype,"fullscreen",void 0);exports.default=()=>(t.SafButton(),i.default(),p.define({name:e.getComponentName("saf-side-nav"),template:u.html`
	<template
		class="${e=>e.fullscreen?"fullscreen":void 0}"
		tabindex="${e=>e.fullscreen&&e.state===m?"0":void 0}"
		?aria-hidden="${e=>e.fullscreen&&e.state===h}"
		open-icon-name="${e=>e.openIconName}"
		close-icon-name="${e=>e.closeIconName}"
		state="${e=>e.state}"
		role="${e=>e.fullscreen?"dialog":"navigation"}"
		aria-modal="${e=>e.fullscreen?e.fullscreen:void 0}"
		?no-focus-trap="${e=>!!e.noFocusTrap&&e.noFocusTrap}"
		?fullscreen="${e=>e.fullscreen?e.fullscreen:void 0}"
		aria-describedby="${e=>e.ariaDescribedby}"
		aria-labelledby="${e=>{var t;return e.ariaLabel?null:(null===(t=e.titleNodes)||void 0===t?void 0:t.length)>0?`header-title-${e.id}`:null}}"
	>
		<header class="header" tabindex="-1" part="header" role="none">
			<div
				class="header-title"
				part="header-title"
				tabindex="-1"
				id="header-title-${e=>e.id}"
			>
				<slot name="title" ${c.slotted({property:"titleNodes"})}></slot>
			</div>
			<saf-button
				nested-item
				class="header-action"
				part="header-action"
				id="${e=>e.id}"
				a11y-aria-label="${e=>e.fullscreen?"Close":e.state===h?"Expand Menu Links":"Collapse Menu Links"}"
				icon-only=""
				appearance="tertiary"
				@click="${e=>e.state===h?e.open():e.close()}"
				><saf-icon
					size="16"
					icon-name=${e=>e.fullscreen?"xmark-large":e.state===h?e.openIconName:e.closeIconName}
				></saf-icon>
			</saf-button>
		</header>
		<menu
			class="body"
			part="body"
			role="menubar"
			aria-label="${e=>e.ariaLabel?e.ariaLabel:void 0}"
			aria-orientation="vertical"
		>
			<slot
				${c.slotted({property:"items",filter:c.elements("saf-menu-item")})}
				@change="${e=>e.handleChange(e.items,"items")}"
				@click="${(e,t)=>e.handleClick(t.event)}"
				@keydown="${(e,t)=>e.handleMenuKeyDown(t.event)}"
			>
			</slot>
		</menu>
	</template>
`,styles:u.css`
	${e.replaceComponentNamesWithSafAttribute(':host{--saf-sideNav-container-height: 100vh;--saf-sideNav-container-left: 0;--saf-sideNav-container-position: sticky;--saf-sideNav-container-top: 0;--saf-sideNav-container-transitionDuration: 0.3s;--saf-sideNav-container-transitionTimingFunction: linear;--saf-sideNav-container-width: 240px;--saf-sideNav-menu-padding: var(--saf-spacing-2);background:var(--saf-color-background-strong);border-right:var(--saf-line-width-thin) solid var(--saf-color-border-strong);box-shadow:var(--saf-drop-shadow-inset);box-sizing:border-box;display:flex;flex-direction:column;height:var(--saf-sideNav-container-height);left:var(--saf-sideNav-container-left);max-width:var(--saf-sideNav-container-width);position:var(--saf-sideNav-container-position);top:var(--saf-sideNav-container-top);transition:width var(--saf-sideNav-container-transitionDuration) var(--saf-sideNav-container-transitionTimingFunction),min-width var(--saf-sideNav-container-transitionDuration) var(--saf-sideNav-container-transitionTimingFunction),max-width var(--saf-sideNav-container-transitionDuration) var(--saf-sideNav-container-transitionTimingFunction);width:var(--saf-sideNav-container-width);z-index:var(--saf-z-index-side-nav)}.header{align-items:center;border-bottom:var(--saf-line-width-thin) solid var(--saf-color-border-strong);display:grid;grid-template-areas:"header-title header-action";grid-template-columns:1fr auto;padding:var(--saf-spacing-2);transition:grid-template-columns var(--saf-sideNav-container-transitionDuration) var(--saf-sideNav-container-transitionTimingFunction);z-index:1}:host([fullscreen]) .header{border-top:var(--saf-line-width-thin) solid var(--saf-color-line-strong);gap:var(--saf-spacing-2);padding:var(--saf-spacing-2) var(--saf-spacing-4)}:host(:not([fullscreen])) .header{gap:0}:host(:not([fullscreen])[state=closed]) .header{grid-template-columns:0 auto}.header-title{color:var(--saf-color-text-heavy);grid-area:header-title}:host(:not([fullscreen])) .header-title{display:none}.header-title:focus,.header-title:focus-visible{outline:none}.header-action{grid-area:header-action;height:40px;width:40px}.body{display:flex;flex-direction:column;flex-grow:1;gap:var(--saf-spacing-2);margin:0;overflow-y:auto;padding:var(--saf-sideNav-menu-padding);position:relative}:host ::slotted(saf-divider){margin:0 calc(var(--saf-sideNav-menu-padding)*-1)}:host([fullscreen]) ::slotted(saf-menu-item){max-width:none}:host([state=closed]){--saf-sideNav-container-width: 56px;min-width:min-content}:host([state=closed]) .header-title{flex-grow:0}:host([state=closed]) .body ::slotted(saf-menu-item){max-width:40px;min-height:40px;min-width:40px;--saf-menu-item-gap: 0}:host([fullscreen]){--saf-sideNav-container-position: fixed;--saf-sideNav-container-height: 100%;--saf-sideNav-container-width: 100%;border:none;box-shadow:none;inset:0;transform-origin:top left;transition:opacity .2s linear,translate .2s linear,width .2s linear;z-index:var(--saf-z-index-dialog)}:host([fullscreen].opening){display:flex;opacity:0;translate:-100% 0}:host([fullscreen][state=closed]){display:none}@media(height <= 400px){:host(:not([fullscreen])){--saf-sideNav-container-height: 100%;--saf-sideNav-container-position: static}:host(:not([fullscreen])) .body{overflow-y:visible}}')}
`,registry:e.getRegistry()})),exports.safSideNavConfig={events:{onClose:"close",onOpen:"open"}};
