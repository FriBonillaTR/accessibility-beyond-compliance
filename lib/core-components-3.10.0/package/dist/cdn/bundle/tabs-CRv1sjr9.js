"use strict";var t=require("tslib"),e=require("@microsoft/fast-web-utilities"),i=require("./apply-mixins-CewQe2EQ.js"),s=require("./start-end-template-D7dQJgd3.js"),a=require("./fast-element-DOTfrYFb.js");class n extends a.FASTElement{constructor(){super(...arguments),this.orientation=e.Orientation.horizontal,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=t=>"true"===t.getAttribute("aria-disabled"),this.isHiddenElement=t=>t.hasAttribute("hidden"),this.isFocusableElement=t=>!this.isDisabledElement(t)&&!this.isHiddenElement(t),this.handleTabClick=t=>{const e=t.currentTarget;1===e.nodeType&&this.isFocusableElement(e)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(e),this.setComponent())},this.handleTabKeyDown=t=>{if(this.isHorizontal())switch(t.key){case e.keyArrowLeft:t.preventDefault(),this.adjustBackward(t);break;case e.keyArrowRight:t.preventDefault(),this.adjustForward(t)}else switch(t.key){case e.keyArrowUp:t.preventDefault(),this.adjustBackward(t);break;case e.keyArrowDown:t.preventDefault(),this.adjustForward(t)}switch(t.key){case e.keyHome:t.preventDefault(),this.adjust(-this.activeTabIndex);break;case e.keyEnd:t.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1)}}}orientationChanged(){this.$fastController.isConnected&&this.setTabs()}activeidChanged(t,e){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex(e=>e.id===t),this.setTabs())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs())}getActiveIndex(){return void 0!==this.activeid?-1===this.tabIds.indexOf(this.activeid)?0:this.tabIds.indexOf(this.activeid):0}setTabs(){const t="gridColumn",e="gridRow",i=this.isHorizontal()?t:e;this.activeTabIndex=this.getActiveIndex(),this.tabs.forEach((s,a)=>{if("tab"===s.slot){const t=this.activeTabIndex===a&&this.isFocusableElement(s),e=this.tabIds[a],i=this.tabpanelIds[a];s.setAttribute("id",e),s.setAttribute("aria-selected",t?"true":"false"),s.setAttribute("aria-controls",i),s.addEventListener("click",this.handleTabClick),s.addEventListener("keydown",this.handleTabKeyDown),s.setAttribute("tabindex",t?"0":"-1"),t&&(this.activetab=s,this.activeid=e)}s.style[t]="",s.style[e]="",s.style[i]=`${a+1}`,this.isHorizontal()?s.classList.remove("vertical"):s.classList.add("vertical")}),this.setTabPanels()}setTabPanels(){this.tabpanels.forEach((t,e)=>{const i=this.tabIds[e],s=this.tabpanelIds[e];t.setAttribute("id",s),t.setAttribute("aria-labelledby",i),this.activeTabIndex!==e?t.setAttribute("hidden",""):t.removeAttribute("hidden")})}getTabIds(){return this.tabs.map(t=>{var i;return null!==(i=t.getAttribute("id"))&&void 0!==i?i:`tab-${e.uniqueId()}`})}getTabPanelIds(){return this.tabpanels.map(t=>{var i;return null!==(i=t.getAttribute("id"))&&void 0!==i?i:`panel-${e.uniqueId()}`})}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===e.Orientation.horizontal}adjust(t){const i=this.tabs.filter(t=>this.isFocusableElement(t)),s=i.indexOf(this.activetab),a=e.limit(0,i.length-1,s+t),n=this.tabs.indexOf(i[a]);n>-1&&this.moveToTabByIndex(this.tabs,n)}adjustForward(t){const e=this.tabs;let i=0;for(i=this.activetab?e.indexOf(this.activetab)+1:1,i===e.length&&(i=0);i<e.length&&e.length>1;){if(this.isFocusableElement(e[i])){this.moveToTabByIndex(e,i);break}if(this.activetab&&i===e.indexOf(this.activetab))break;i+1>=e.length?i=0:i+=1}}adjustBackward(t){const e=this.tabs;let i=0;for(i=this.activetab?e.indexOf(this.activetab)-1:0,i=i<0?e.length-1:i;i>=0&&e.length>1;){if(this.isFocusableElement(e[i])){this.moveToTabByIndex(e,i);break}i-1<0?i=e.length-1:i-=1}}moveToTabByIndex(t,e){const i=t[e];this.activetab=i,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=e,i.focus(),this.setComponent()}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}}t.__decorate([a.attr],n.prototype,"orientation",void 0),t.__decorate([a.attr],n.prototype,"activeid",void 0),t.__decorate([a.observable],n.prototype,"tabs",void 0),t.__decorate([a.observable],n.prototype,"tabpanels",void 0),t.__decorate([a.attr({attribute:"a11y-aria-label"})],n.prototype,"a11yAriaLabel",void 0),i.applyMixins(n,s.StartEnd),exports.Tabs=n;
